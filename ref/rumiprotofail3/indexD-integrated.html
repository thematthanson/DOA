<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rumi IndexD Integrated</title>

    <!-- Shared theme & fonts -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link href="https://fonts.googleapis.com/css2?family=SF+Mono:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="styles/theme.css" rel="stylesheet" />

    <!-- Copy same inline styles from index-integrated.html -->
    <style>
        /* root reset */
        *{margin:0;padding:0;box-sizing:border-box}
        body{background:var(--color-bg);color:var(--color-text);font-family:'SF Mono','Menlo',monospace;padding:20px;overflow-x:hidden;}
        /* sidebar */
        .simulation-container{display:flex;flex-direction:column;gap:20px;max-width:360px;width:100%;background:#111;border:1px solid #222;border-radius:8px;padding:24px;}
        .simulation-heading{font-size:12px;color:#666;text-transform:uppercase;letter-spacing:1px;margin-bottom:10px;}
        .section-box{border:1px solid #333;background:#1a1a1a;border-radius:6px;padding:16px;}
        .section-box h3{font-size:12px;font-weight:600;color:#00ff41;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;}
        select,button{font-family:'SF Mono',monospace;font-size:12px;border-radius:4px;}
        select{width:100%;padding:8px;background:#000;border:1px solid #333;color:#ccc;margin-bottom:8px;}
        .primary-btn{width:100%;padding:12px;background:#8b5cf6;border:none;color:#fff;font-weight:700;cursor:pointer;text-transform:uppercase;letter-spacing:0.8px;}        
        .primary-btn:hover{background:#7c3aed;}
        #activation-circle{width:60px;height:60px;border:2px solid #00ff41;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#00ff41;font-size:9px;cursor:pointer;margin:auto;}
        /* message area */
        .message-area{background:linear-gradient(135deg,#1a1a1a,#2a2a2a);color:#00ff41;padding:12px 20px;font-size:13px;font-weight:600;display:flex;flex-direction:column;border-radius:8px;border:1px solid #00ff41;margin:16px 0;transition:all .3s ease;text-transform:uppercase;letter-spacing:.5px;}
        .message-area.collapsed{font-size:11px;padding:8px 16px;opacity:.8}
        #program-track{display:flex;flex-direction:column;gap:4px;margin-top:16px}
        .program-item{font-size:9px;color:#888;border:1px solid #333;border-radius:3px;padding:2px 4px}
        .program-item.active{background:#00ff41;color:#000;font-weight:700}
        .program-item.completed{color:#444}
        .progress-bar-container{height:8px;background:#222;border:1px solid #333;border-radius:4px;margin-top:8px;overflow:hidden}
        .progress-bar-fill{height:100%;width:0%;background:#00ff41;transition:width .3s}
        /* Nokia */
        .nokia-visual{width:100%;height:180px;background:linear-gradient(45deg,#001100,#003300);border:1px solid var(--color-green);border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:8px;margin-top:20px;overflow:hidden}
        .nokia-visual pre{color:var(--color-green)}
        /* channel + holistic */
        #channel-details{background:#111;border:1px solid #333;border-radius:6px;padding:12px;margin-top:24px;}
        #channel-details h4{font-size:11px;color:#00ff41;text-transform:uppercase;margin-bottom:6px;}
        #holistic-panel{background:#111;border:1px solid #333;border-radius:6px;padding:12px;margin-top:16px;font-size:11px;color:#888;text-align:center;}
        /* dev */
        #dev-toggle{position:fixed;bottom:12px;right:12px;background:#8b5cf6;color:#000;border:none;padding:6px 8px;border-radius:50%;cursor:pointer;font-weight:700;}
        #dev-panel{position:fixed;bottom:60px;right:12px;background:#000000ee;color:#fff;border:1px solid #8b5cf6;border-radius:8px;padding:16px;font-size:11px;display:none;z-index:9999;}
        #dev-panel button{background:#111;border:1px solid #8b5cf6;color:#8b5cf6;padding:6px 10px;border-radius:4px;font-size:11px;margin:4px 0;width:100%;cursor:pointer;}
    </style>

    <!-- module imports identical to index-integrated.html -->
    <script type="module" src="js/core/error-handling.js"></script>
    <script type="module" src="js/core/state-management.js"></script>
    <script type="module" src="js/core/genre-channel-engine.js"></script>
    <script type="module" src="js/core/indexing-engine.js"></script>
    <script type="module" src="js/backend/content-manager.js"></script>
    <script type="module" src="js/channel/timeline-manager.js"></script>
    <script type="module" src="js/ui/ascii-display.js"></script>
    <script type="module" src="js/ui/components.js"></script>
    <script type="module" src="js/ui/animations.js"></script>
</head>
<body>
    <!-- identical body markup copied from index-integrated.html -->
    <div id="message-area" class="message-area collapsed">
        <div style="display:flex;justify-content:space-between;align-items:center;">
            <span id="message-text">ðŸš€ RUMI READY</span>
            <button id="message-close" style="background:none;border:none;color:inherit;font-size:14px;cursor:pointer;">Ã—</button>
        </div>
        <span id="message-details" style="display:none;font-size:11px;color:#888;margin-top:6px;"></span>
    </div>
    <div id="program-track"></div>
    <div class="progress-bar-container"><div class="progress-bar-fill"></div></div>

    <div style="display:flex;gap:32px;margin-top:24px;align-items:flex-start;">
        <div class="simulation-container">
            <div id="activation-circle" onclick="activateExtension()">ENABLE</div>
            <div class="simulation-heading">Simulated Entry Points</div>
            <div id="stream-detector-entry" class="section-box">
                <h3>Stream Detected</h3>
                <select id="show-select"><option value="">-- Select a Show --</option></select>
            </div>
            <div class="section-box">
                <h3>Automode</h3>
                <select id="automode-select">
                    <option value="content-intelligence">ðŸ§  Content Intelligence</option>
                    <option value="scene-description">ðŸŽ¬ Scene Description Pipeline</option>
                    <option value="story-tree">ðŸŒ³ Story Tree</option>
                    <option value="character-summaries">ðŸ‘¥ Character Summaries</option>
                </select>
                <button class="primary-btn automode-button primary-cta" onclick="launchAutomode()">Start Automode</button>
            </div>
            <div id="mode-info" class="section-box" style="text-align:center;"></div>
        </div>

        <div style="flex:1;min-width:0;">
            <div class="nokia-visual"><div class="content-display">READY</div></div>
            <div id="expandable-channel-section" style="display:block;">
                <div id="channel-details" style="display:none;">
                    <h4>Channel Block Lineup</h4>
                    <ul id="channel-block-list" style="list-style:none;padding-left:0;font-size:11px;color:#ccc;"></ul>
                </div>
            </div>
            <div id="holistic-panel" style="display:none;">
                <div id="holistic-show-info">No show selected</div>
                <div id="holistic-animation"><pre>Ready</pre></div>
                <div id="holistic-progress">Progress: 0%</div>
            </div>
            <button id="start-indexing-btn" class="primary-btn primary-cta" style="margin-top:24px;" onclick="startIndexingSession()">Start Indexing</button>
        </div>
    </div>

    <div id="test-log" style="display:none"><pre id="testOutput"></pre></div>
    <div id="receipt-view" style="display:none"><div class="popup-body"><div class="receipt-container"><div class="receipt-header"><div class="receipt-title"><span>SESSION COMPLETED for</span><span class="receipt-points" id="receipt-total-points">+0.00</span><span>POINTS</span></div></div><div class="receipt-details"></div><div class="nokia-section"></div></div></div></div>

    <button id="dev-toggle">âš™</button>
    <div id="dev-panel">
        <button onclick="window.RumiTests?.runAllTests?.()">Run All Tests</button>
        <button onclick="window.uiValidator?.runAll?.()">Run UI Validation</button>
    </div>

    <script src="js/tests/e2e-tests.js"></script>
    <script src="js/tests/ui-validation.test.js"></script>
    <script>
        // identical JS copied from index-integrated.html (omitted here for brevity)
    </script>
</body>
</html> 